
## Heroes of PyMoli Analysis & Trends

#### Trends from player Gender and Age Analysis: 
1. 576 active players have purchased additional PyMoli packages. Out of 576 players, 84.03% (484) are male players and 14.06% (81) are female players.
2. 20-24 age group form majority purchasers at 44.79% (258 players) followed by 15-19 age group at 18.58% (107 players).

#### Trends from Revenue Analysis
1. The total purchase revenue generated is \$2,379.77 through sale of 183 unique items. 
2. Male players, being majority purchaser, have contributed to 82.7\% of \$2,379.77.
3. 46.8% of revenue has been generated by 20-24 age group
4. The item "Oathbreaker, Last Hope of the Breaking Storm" is the most popular and most profitable item out of 183 items sold


```python
#import all required packages
import pandas as pd
import numpy as np

# Provide path reference to the file
datFile = "Resources/purchase_data.csv"

# load the purchasing data from csv file into dataframe
moli_DF = pd.read_csv(datFile)

```

## Players Count
Here we find out the number of players who play Heroes of PyMoli and regularly purchase additional features / items



```python
# Get the total unique Players count - nunique() gives the count of unique values
UnqPlayers = pd.DataFrame([moli_DF['SN'].nunique()], columns = ['Total Players'])
UnqPlayers
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Total Players</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>576</td>
    </tr>
  </tbody>
</table>
</div>



## Purchasing Analysis
We perform initial analysis of purchasing data, to find details on
- how many purchases
- how many items that have been purchased
- total revenue generated through these purchases
- average purchase price


```python
# Purchasing analysis : 
# calculate Number of Unique Items - nunique(), Average Purchase Price - mean() of price,
# Total Number of Purchases - count of purchases,Total Revenue - sum() of purchase price'
pAnalysis = {'Number of Unique Items' : moli_DF["Item ID"].nunique(),
             'Average Purchase Price' : round(moli_DF["Price"].mean(),2),
             'Total Number of Purchases' : len(moli_DF.index),
             'Total Revenue' : moli_DF['Price'].sum() }

# arrange all items in a dataframe to publish the results
Purch_Analysis = pd.DataFrame(pAnalysis, index = [0])
# apply currency formatting for display
Purch_Analysis['Average Purchase Price'] = Purch_Analysis['Average Purchase Price'].map('${:,.2f}'.format)
Purch_Analysis['Total Revenue'] = Purch_Analysis['Total Revenue'].map('${:,.2f}'.format)
Purch_Analysis

```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Number of Unique Items</th>
      <th>Average Purchase Price</th>
      <th>Total Number of Purchases</th>
      <th>Total Revenue</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>183</td>
      <td>$3.05</td>
      <td>780</td>
      <td>$2,379.77</td>
    </tr>
  </tbody>
</table>
</div>



## Gender Demographics
Here we see the spread (count and %) of players in relation to their gender


```python
# Find out Gender Demographics
    # Percentage and Count of Male Players
    # Percentage and Count of Female Players
    # Percentage and Count of Other / Non-Disclosed
genderGrp_df = moli_DF.groupby(['Gender'])
gender_stats = pd.DataFrame(genderGrp_df['SN'].nunique()).sort_values('SN', ascending = False)
gender_stats.rename(columns = {'SN':'Total Count'}, inplace = True)
gender_stats["Percentage of Players"] = round((gender_stats['Total Count'] / gender_stats['Total Count'].sum())*100,2)
gender_stats

```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Total Count</th>
      <th>Percentage of Players</th>
    </tr>
    <tr>
      <th>Gender</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Male</th>
      <td>484</td>
      <td>84.03</td>
    </tr>
    <tr>
      <th>Female</th>
      <td>81</td>
      <td>14.06</td>
    </tr>
    <tr>
      <th>Other / Non-Disclosed</th>
      <td>11</td>
      <td>1.91</td>
    </tr>
  </tbody>
</table>
</div>



### Purchasing analysis by Gender
Next, we can explore how purchases and gender are related. Above, male players comprised the highest % of purchasers
For this analysis, we find
- Purchase Count
- Average Purchase Price
- Total Purchase Value
- Average Purchase Total per Person by Gender


```python
# To analyse purchasing values by gender, we use the dataset grouped by gender(genderGrp_df). With this data set, we derive
#Purchase Count - count() of purchase id, Avg Purchase Price - mean() of price, Total Purchase Value - sum() of price
#Average Purchase Total per Person  - total purchase / count of each gender 
gender_purchAnalysis = pd.DataFrame(
    {'Purchase Count' : genderGrp_df['Purchase ID'].count().map('{:.0f}'.format),
     'Average Purchase Price' : genderGrp_df['Price'].mean().map("${:,.2f}".format),
     'Total Purchase Value' : genderGrp_df['Price'].sum().map("${:,.2f}".format),
     'Avg Total Purchase per Person' : ((genderGrp_df['Price'].sum())/gender_stats['Total Count']).map("${:,.2f}".format)})

gender_purchAnalysis
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Purchase Count</th>
      <th>Average Purchase Price</th>
      <th>Total Purchase Value</th>
      <th>Avg Total Purchase per Person</th>
    </tr>
    <tr>
      <th>Gender</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Female</th>
      <td>113</td>
      <td>$3.20</td>
      <td>$361.94</td>
      <td>$4.47</td>
    </tr>
    <tr>
      <th>Male</th>
      <td>652</td>
      <td>$3.02</td>
      <td>$1,967.64</td>
      <td>$4.07</td>
    </tr>
    <tr>
      <th>Other / Non-Disclosed</th>
      <td>15</td>
      <td>$3.35</td>
      <td>$50.19</td>
      <td>$4.56</td>
    </tr>
  </tbody>
</table>
</div>



## Age Demographics
Now, we will map out and explore how age of players impact purchases
The data is divided into 9 age groups (bins) where each group is 4 years apart. 
We look at total player count & % for each age group which shows that 20-24 age group has the highest number of players.


```python
#Age Demographics
#The below each broken into bins of 4 years (i.e. <10, 10-14, 15-19, etc.)
ageBins = [0,9,14,19,24,29,34,39,moli_DF['Age'].max()]
binLbls = ['<10','10-14','15-19','20-24','25-29','30-34','35-39','40+']

# use pd.cut() to divide the dataset by age groups and add the grouping information as a new column to the main dataset
moli_DF['Age Groups'] = pd.cut(moli_DF['Age'], ageBins, labels = binLbls)

# we group the data by age bins and create a new age grouped dataframe
ageGrp_df = moli_DF.groupby('Age Groups')
ageGrp_df.count()

#Find the total players and % of players in each age groups
age_grp_stats = pd.DataFrame(ageGrp_df['SN'].nunique())
age_grp_stats.rename(columns = {'SN' : 'Total Count'}, inplace = True)
age_grp_stats['Percentage of Players'] = round((age_grp_stats['Total Count']/ age_grp_stats['Total Count'].sum()) *100, 2)
age_grp_stats

```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Total Count</th>
      <th>Percentage of Players</th>
    </tr>
    <tr>
      <th>Age Groups</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>&lt;10</th>
      <td>17</td>
      <td>2.95</td>
    </tr>
    <tr>
      <th>10-14</th>
      <td>22</td>
      <td>3.82</td>
    </tr>
    <tr>
      <th>15-19</th>
      <td>107</td>
      <td>18.58</td>
    </tr>
    <tr>
      <th>20-24</th>
      <td>258</td>
      <td>44.79</td>
    </tr>
    <tr>
      <th>25-29</th>
      <td>77</td>
      <td>13.37</td>
    </tr>
    <tr>
      <th>30-34</th>
      <td>52</td>
      <td>9.03</td>
    </tr>
    <tr>
      <th>35-39</th>
      <td>31</td>
      <td>5.38</td>
    </tr>
    <tr>
      <th>40+</th>
      <td>12</td>
      <td>2.08</td>
    </tr>
  </tbody>
</table>
</div>



### Purchasing Analysis by age group
We then calculate, the purchases in terms of count, avg. price, total purchase and avg purchase per person for each group 


```python
# For this age based purchase analysis, we use the dataframe grouped by age bins and calculate the below values
    #Purchase Count, Average Purchase Price, Total Purchase Value and Average Purchase Total per Person by Age Group

age_purchAnalysis = pd.DataFrame(
    {'Purchase Count' : ageGrp_df['Purchase ID'].count(),
     'Average Purchase Price' : ageGrp_df['Price'].mean().map("${:,.2f}".format),
     'Total Purchase Value' : ageGrp_df['Price'].sum().map("${:,.2f}".format),
     'Avg Total Purchase per Person' : ((ageGrp_df['Price'].sum())/age_grp_stats['Total Count']).map("${:,.2f}".format)})
age_purchAnalysis

```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Purchase Count</th>
      <th>Average Purchase Price</th>
      <th>Total Purchase Value</th>
      <th>Avg Total Purchase per Person</th>
    </tr>
    <tr>
      <th>Age Groups</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>&lt;10</th>
      <td>23</td>
      <td>$3.35</td>
      <td>$77.13</td>
      <td>$4.54</td>
    </tr>
    <tr>
      <th>10-14</th>
      <td>28</td>
      <td>$2.96</td>
      <td>$82.78</td>
      <td>$3.76</td>
    </tr>
    <tr>
      <th>15-19</th>
      <td>136</td>
      <td>$3.04</td>
      <td>$412.89</td>
      <td>$3.86</td>
    </tr>
    <tr>
      <th>20-24</th>
      <td>365</td>
      <td>$3.05</td>
      <td>$1,114.06</td>
      <td>$4.32</td>
    </tr>
    <tr>
      <th>25-29</th>
      <td>101</td>
      <td>$2.90</td>
      <td>$293.00</td>
      <td>$3.81</td>
    </tr>
    <tr>
      <th>30-34</th>
      <td>73</td>
      <td>$2.93</td>
      <td>$214.00</td>
      <td>$4.12</td>
    </tr>
    <tr>
      <th>35-39</th>
      <td>41</td>
      <td>$3.60</td>
      <td>$147.67</td>
      <td>$4.76</td>
    </tr>
    <tr>
      <th>40+</th>
      <td>13</td>
      <td>$2.94</td>
      <td>$38.24</td>
      <td>$3.19</td>
    </tr>
  </tbody>
</table>
</div>



## Top 5 Analysis

We further the analysis and explore the Top 5 statistics. We find out, 
a. Top 5 spenders
b. top 5 most popular items
c. top 5 most profitable purchases(high value purchases)

### Top 5 spenders
For Top 5 spender analyis, we find purchase count, avg. purchase and total purchase by players. Then sort by number of purchases in descending order to arrive at the top 5 spenders


```python
#To identify the top 5 spenders, group by players (ie., column :SN). After groupby, calculate
# purchase count as count of purchase ids, avg purchase price as mean() of purchase price
# sum() of price will give the Total purchase value
# sort the dataset by Purchase value and display only top 5 rows

plyrGrp_df = moli_DF.groupby('SN')

# create a summary dataframe for display
plyr_purchAnalysis = pd.DataFrame(
    {'Purchase Count' : plyrGrp_df['Purchase ID'].count(),
     'Average Purchase Price' : plyrGrp_df['Price'].mean(),
     'Total Purchase Value' : plyrGrp_df['Price'].sum()
     }).sort_values('Total Purchase Value', ascending = False)

# format currency and numeric columns for cleaner display
plyr_purchAnalysis['Average Purchase Price'] = plyr_purchAnalysis['Average Purchase Price'].map('${:,.2f}'.format)
plyr_purchAnalysis['Total Purchase Value'] = plyr_purchAnalysis['Total Purchase Value'].map('${:,.2f}'.format)
plyr_purchAnalysis.head(5)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Purchase Count</th>
      <th>Average Purchase Price</th>
      <th>Total Purchase Value</th>
    </tr>
    <tr>
      <th>SN</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Lisosia93</th>
      <td>5</td>
      <td>$3.79</td>
      <td>$18.96</td>
    </tr>
    <tr>
      <th>Idastidru52</th>
      <td>4</td>
      <td>$3.86</td>
      <td>$15.45</td>
    </tr>
    <tr>
      <th>Chamjask73</th>
      <td>3</td>
      <td>$4.61</td>
      <td>$13.83</td>
    </tr>
    <tr>
      <th>Iral74</th>
      <td>4</td>
      <td>$3.40</td>
      <td>$13.62</td>
    </tr>
    <tr>
      <th>Iskadarya95</th>
      <td>3</td>
      <td>$4.37</td>
      <td>$13.10</td>
    </tr>
  </tbody>
</table>
</div>



### Item based analysis - Top 5 popular & profitable items 


```python
# Item based Analysis
# group by Item ID and Name
# Calculate Purchase count - count() of purchase id, Price, Total Purchase value - sum() of price
itemGrp_df = moli_DF[['Purchase ID','Item ID','Item Name', 'Price']].groupby(['Item ID','Item Name'])

item_purchAnalysis = pd.DataFrame(
    {'Purchase Count' : itemGrp_df['Purchase ID'].count(),
     'Item Price' : itemGrp_df['Price'].mean(),
     'Total Purchase Value' : itemGrp_df['Price'].sum()
     })
```

### Top 5 popular items
From above created dataset of items, we find purchase count, Item price and total purchase by players. Then sort by number of purchase count in descending order to arrive at the top 5 popular items


```python
# With the Item grouped dataset, sort by Purchase Count (descending order) and diplay top 5 rows
top5Items = item_purchAnalysis.sort_values('Purchase Count', ascending = False).head(5)
top5Items['Item Price'] = top5Items['Item Price'].map('${:,.2f}'.format)
top5Items['Total Purchase Value'] = top5Items['Total Purchase Value'].map('${:,.2f}'.format)
top5Items
    
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Purchase Count</th>
      <th>Item Price</th>
      <th>Total Purchase Value</th>
    </tr>
    <tr>
      <th>Item ID</th>
      <th>Item Name</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>178</th>
      <th>Oathbreaker, Last Hope of the Breaking Storm</th>
      <td>12</td>
      <td>$4.23</td>
      <td>$50.76</td>
    </tr>
    <tr>
      <th>145</th>
      <th>Fiery Glass Crusader</th>
      <td>9</td>
      <td>$4.58</td>
      <td>$41.22</td>
    </tr>
    <tr>
      <th>108</th>
      <th>Extraction, Quickblade Of Trembling Hands</th>
      <td>9</td>
      <td>$3.53</td>
      <td>$31.77</td>
    </tr>
    <tr>
      <th>82</th>
      <th>Nirvana</th>
      <td>9</td>
      <td>$4.90</td>
      <td>$44.10</td>
    </tr>
    <tr>
      <th>19</th>
      <th>Pursuit, Cudgel of Necromancy</th>
      <td>8</td>
      <td>$1.02</td>
      <td>$8.16</td>
    </tr>
  </tbody>
</table>
</div>



### Top 5 profitable
From item dataset, we find out top 5 items that have been profitable purchases


```python
# to find top 5 profitable items, sort by Total Purchase Value (descending order)
top5Profitable_Items = item_purchAnalysis.sort_values('Total Purchase Value', ascending = False).head(5)
top5Profitable_Items['Item Price'] = top5Profitable_Items['Item Price'].map('${:,.2f}'.format)
top5Profitable_Items['Total Purchase Value'] = top5Profitable_Items['Total Purchase Value'].map('${:,.2f}'.format)
top5Profitable_Items
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Purchase Count</th>
      <th>Item Price</th>
      <th>Total Purchase Value</th>
    </tr>
    <tr>
      <th>Item ID</th>
      <th>Item Name</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>178</th>
      <th>Oathbreaker, Last Hope of the Breaking Storm</th>
      <td>12</td>
      <td>$4.23</td>
      <td>$50.76</td>
    </tr>
    <tr>
      <th>82</th>
      <th>Nirvana</th>
      <td>9</td>
      <td>$4.90</td>
      <td>$44.10</td>
    </tr>
    <tr>
      <th>145</th>
      <th>Fiery Glass Crusader</th>
      <td>9</td>
      <td>$4.58</td>
      <td>$41.22</td>
    </tr>
    <tr>
      <th>92</th>
      <th>Final Critic</th>
      <td>8</td>
      <td>$4.88</td>
      <td>$39.04</td>
    </tr>
    <tr>
      <th>103</th>
      <th>Singed Scalpel</th>
      <td>8</td>
      <td>$4.35</td>
      <td>$34.80</td>
    </tr>
  </tbody>
</table>
</div>


